<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>TMalign &#8212; Lemon master documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/lemon.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="shortcut icon" href="_static/icon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Read command-line options" href="options.html" />
    <link rel="prev" title="XScore/Vina" href="xscore.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><span><img src="_static/icon.svg"></span>
          Lemon</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Navigation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Useful Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="select.html">Select</a></li>
<li class="toctree-l1"><a class="reference internal" href="prune.html">Prune</a></li>
<li class="toctree-l1"><a class="reference internal" href="count.html">Counting operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="separate.html">Separate</a></li>
<li class="toctree-l1"><a class="reference internal" href="return.html">Handling Custom Returns in C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="return.html#python-alternative">Python alternative</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="xscore.html">XScore/Vina</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">TMalign</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="options.html">Read command-line options</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel.html">Launch a <strong>Lemon</strong> workflow</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="count_residues.html">Example Programs for counting residues</a></li>
<li class="toctree-l1"><a class="reference internal" href="small_molecules.html">Example programs for finding ligand interactions</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="xscore.html" title="Previous Chapter: XScore/Vina"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; XScore/Vina</span>
    </a>
  </li>
  <li>
    <a href="options.html" title="Next Chapter: Read command-line options"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Read command-... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Useful Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="select.html">Select</a></li>
<li class="toctree-l1"><a class="reference internal" href="prune.html">Prune</a></li>
<li class="toctree-l1"><a class="reference internal" href="count.html">Counting operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="separate.html">Separate</a></li>
<li class="toctree-l1"><a class="reference internal" href="return.html">Handling Custom Returns in C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="return.html#python-alternative">Python alternative</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="xscore.html">XScore/Vina</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">TMalign</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-tmscore-function-for-alignment">The TMscore function for alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="options.html">Read command-line options</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel.html">Launch a <strong>Lemon</strong> workflow</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="count_residues.html">Example Programs for counting residues</a></li>
<li class="toctree-l1"><a class="reference internal" href="small_molecules.html">Example programs for finding ligand interactions</a></li>
</ul>

<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="tmalign">
<h1>TMalign<a class="headerlink" href="#tmalign" title="Permalink to this headline">¶</a></h1>
<p>Some users may wish to write <strong>Lemon</strong> workflows that involve the alignment of
a potential protein to a reference protein. Potential applications include the
creation of a benchmarking set of all proteins with a given fold or motif. To
address this, we’ve included the <em>TMalign</em> algorithm within <strong>Lemon</strong>.</p>
<p><strong>Note:</strong> You will need to include the additional file: <cite>&lt;lemon/tmalign.hpp&gt;</cite>
to have access to these features.</p>
<div class="section" id="the-tmscore-function-for-alignment">
<h2>The TMscore function for alignment<a class="headerlink" href="#the-tmscore-function-for-alignment" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="_CPPv4N5lemon7tmalign8TMResultE">
<span id="_CPPv3N5lemon7tmalign8TMResultE"></span><span id="_CPPv2N5lemon7tmalign8TMResultE"></span><span id="lemon::tmalign::TMResult"></span><span class="target" id="structlemon_1_1tmalign_1_1_t_m_result"></span><em class="property">struct </em><code class="sig-name descname">TMResult</code><a class="headerlink" href="#_CPPv4N5lemon7tmalign8TMResultE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Structure representing the TMScore </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv4N5lemon7tmalign7TMscoreERKN9chemfiles5FrameERKN9chemfiles5FrameE">
<span id="_CPPv3N5lemon7tmalign7TMscoreERKN9chemfiles5FrameERKN9chemfiles5FrameE"></span><span id="_CPPv2N5lemon7tmalign7TMscoreERKN9chemfiles5FrameERKN9chemfiles5FrameE"></span><span id="lemon::tmalign::TMscore__chemfiles::FrameCR.chemfiles::FrameCR"></span><span class="target" id="tmalign_8hpp_1ae3703d366b62aa36f0de4700295897ef"></span><a class="reference internal" href="#_CPPv4N5lemon7tmalign8TMResultE" title="lemon::tmalign::TMResult">TMResult</a> <code class="sig-prename descclassname">lemon::tmalign<code class="sig-prename descclassname">::</code></code><code class="sig-name descname">TMscore</code><span class="sig-paren">(</span><em class="property">const</em> chemfiles::Frame &amp;<em>search</em>, <em class="property">const</em> chemfiles::Frame &amp;<em>native</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5lemon7tmalign7TMscoreERKN9chemfiles5FrameERKN9chemfiles5FrameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>TMalign is an algorithm used to align protein chains in 3D space.</p>
<p>Ported from <a class="reference external" href="https://zhanglab.ccmb.med.umich.edu/TM-score/TMscore_subroutine.f">https://zhanglab.ccmb.med.umich.edu/TM-score/TMscore_subroutine.f</a> Original reference: Yang Zhang, Jeffrey Skolnick, Proteins 2004 57:702-10.</p>
<p>Original License: Permission to use, copy, modify, and distribute this program for any purpose, with or without fee, is hereby granted, provided that the notices on the head, the reference information, and this copyright notice appear in all copies or substantial portions of the Software. It is provided “as is” without express or implied warranty. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>A strucure with the TMScore, and number of aligned residues </p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">search</span></code>: The frame that is being aligned to native. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[in]</span> <span class="pre">native</span></code>: The ‘native’ chain that the search chain is aligned to. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="section" id="c">
<h3>C++<a class="headerlink" href="#c" title="Permalink to this headline">¶</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">lemon</span><span class="o">::</span><span class="n">Options</span> <span class="n">o</span><span class="p">;</span>
<span class="k">auto</span> <span class="n">reference</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;reference.pdb&quot;</span><span class="p">);</span>
<span class="n">o</span><span class="p">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;--reference,-r&quot;</span><span class="p">,</span> <span class="n">reference</span><span class="p">,</span> <span class="s">&quot;Protein or DNA to align to.&quot;</span><span class="p">)</span><span class="o">-&gt;</span>
    <span class="n">check</span><span class="p">(</span><span class="n">CLI</span><span class="o">::</span><span class="n">ExistingFile</span><span class="p">);</span>
<span class="n">o</span><span class="p">.</span><span class="n">parse_command_line</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>

<span class="n">chemfiles</span><span class="o">::</span><span class="n">Trajectory</span> <span class="n">traj</span><span class="p">(</span><span class="n">reference</span><span class="p">);</span>
<span class="n">chemfiles</span><span class="o">::</span><span class="n">Frame</span> <span class="n">native</span> <span class="o">=</span> <span class="n">traj</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>

<span class="k">auto</span> <span class="n">worker</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="n">native</span><span class="p">](</span><span class="k">const</span> <span class="n">chemfiles</span><span class="o">::</span><span class="n">Frame</span><span class="o">&amp;</span> <span class="n">entry</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">pdbid</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="p">{</span>

    <span class="k">auto</span> <span class="n">tm</span> <span class="o">=</span> <span class="n">lemon</span><span class="o">::</span><span class="n">tmalign</span><span class="o">::</span><span class="n">TMscore</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">native</span><span class="p">);</span>

    <span class="k">return</span> <span class="n">pdbid</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span> <span class="o">+</span>
           <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">tm</span><span class="p">.</span><span class="n">score</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span> <span class="o">+</span>
           <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">tm</span><span class="p">.</span><span class="n">rmsd</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span> <span class="o">+</span>
           <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">tm</span><span class="p">.</span><span class="n">aligned</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">auto</span> <span class="n">collector</span> <span class="o">=</span> <span class="n">lemon</span><span class="o">::</span><span class="n">print_combine</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">);</span>
<span class="k">return</span> <span class="n">lemon</span><span class="o">::</span><span class="n">launch</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">worker</span><span class="p">,</span> <span class="n">collector</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="python">
<h3>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lemon</span>

<span class="k">class</span> <span class="nc">MyWorkflow</span><span class="p">(</span><span class="n">lemon</span><span class="o">.</span><span class="n">Workflow</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">lemon</span>
        <span class="n">lemon</span><span class="o">.</span><span class="n">Workflow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">native</span> <span class="o">=</span> <span class="n">lemon</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="s2">&quot;../../../test/files/1AAQ.mmtf&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">worker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">pdbid</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">lemon</span>

        <span class="n">tm</span> <span class="o">=</span> <span class="n">lemon</span><span class="o">.</span><span class="n">TMscore</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">native</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pdbid</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> \
               <span class="nb">str</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">score</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> \
               <span class="nb">str</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">aligned</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> \
               <span class="nb">str</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">affine</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
  <footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
    </p>
    <p class="pull-left">
        &copy; Chopra Lab and Purdue University.
    </p>
    <p class="text-center">
        BSD licensed on <a href="https://github.com/chopralab/lemon">Github</a>
    </p>
  </div>
</footer>

  </body>
</html>